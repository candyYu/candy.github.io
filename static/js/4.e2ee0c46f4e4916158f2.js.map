{"version":3,"sources":["webpack:///./articles/nginx代理.md","webpack:///./articles/nginx代理.md?5b4f","webpack:///./articles/nginx代理.md?30bc"],"names":["module","exports","__webpack_require__","nginx__","render","this","$createElement","_self","_c","_m","staticRenderFns","_vm","_h","_v","pre","attrs","class","v-pre","Component","normalizeComponent","__webpack_exports__"],"mappings":"uCAAAA,EAAAC,QAAAC,EAAA,8FCAA,IAGAC,GADiBC,OAFjB,WAA0BC,KAAaC,eAAbD,KAAuCE,MAAAC,GAAwB,OAA/DH,KAA+DI,GAAA,IAExEC,iBADjB,WAAoC,IAAAC,EAAAN,KAAaO,EAAAD,EAAAL,eAA0BE,EAAAG,EAAAJ,MAAAC,IAAAI,EAAwB,OAAAJ,EAAA,WAAAA,EAAA,MAAAG,EAAAE,GAAA,cAAAF,EAAAE,GAAA,KAAAL,EAAA,KAAAG,EAAAE,GAAA,2BAAAF,EAAAE,GAAA,KAAAL,EAAA,KAAAG,EAAAE,GAAA,wDAAAF,EAAAE,GAAA,KAAAL,EAAA,OAAkNM,KAAA,EAAAC,OAAgBC,MAAA,UAAgBR,EAAA,QAAaO,OAAOE,QAAA,MAAYN,EAAAE,GAAA,qdAA6aF,EAAAE,GAAA,KAAAL,EAAA,MAAAG,EAAAE,GAAA,8BAAAF,EAAAE,GAAA,KAAAL,EAAA,MAAAG,EAAAE,GAAA,2BAAAF,EAAAE,GAAA,KAAAL,EAAA,OAAwLM,KAAA,EAAAC,OAAgBC,MAAA,UAAgBR,EAAA,QAAaO,OAAOE,QAAA,MAAYN,EAAAE,GAAA,kRAAiCF,EAAAE,GAAA,KAAAL,EAAA,MAAAG,EAAAE,GAAA,6BAAAF,EAAAE,GAAA,KAAAL,EAAA,OAAyUM,KAAA,EAAAC,OAAgBC,MAAA,UAAgBR,EAAA,QAAaO,OAAOE,QAAA,MAAYN,EAAAE,GAAA,oMAAmCF,EAAAE,GAAA,KAAAL,EAAA,MAAAG,EAAAE,GAAA,YAAAF,EAAAE,GAAA,KAAAL,EAAA,OAAwOM,KAAA,EAAAC,OAAgBC,MAAA,UAAgBR,EAAA,QAAaO,OAAOE,QAAA,MAAYN,EAAAE,GAAA,wSAAAF,EAAAE,GAAA,KAAAL,EAAA,MAAAG,EAAAE,GAAA,UAAAF,EAAAE,GAAA,KAAAL,EAAA,KAAAG,EAAAE,GAAA,4CAAAF,EAAAE,GAAA,KAAAL,EAAA,OAAwbM,KAAA,EAAAC,OAAgBC,MAAA,UAAgBR,EAAA,QAAaO,OAAOE,QAAA,MAAYN,EAAAE,GAAA,uZAAqZF,EAAAE,GAAA,KAAAL,EAAA,KAAAG,EAAAE,GAAA,2CAAAF,EAAAE,GAAA,KAAAL,EAAA,OAAuGM,KAAA,EAAAC,OAAgBC,MAAA,UAAgBR,EAAA,QAAaO,OAAOE,QAAA,MAAYN,EAAAE,GAAA,gvBAAgvBF,EAAAE,GAAA,KAAAL,EAAA,MAAAG,EAAAE,GAAA,2CAAAF,EAAAE,GAAA,KAAAL,EAAA,OAAsGM,KAAA,EAAAC,OAAgBC,MAAA,UAAgBR,EAAA,QAAaO,OAAOE,QAAA,MAAYN,EAAAE,GAAA,4jECYztHK,EAbAhB,EAAA,OAaAiB,CAXA,KAaAhB,GATA,EAEA,KAEA,KAEA,MAUAiB,EAAA,QAAAF,EAAA","file":"static/js/4.e2ee0c46f4e4916158f2.js","sourcesContent":["module.exports = require(\"!!vue-loader!../node_modules/vue-markdown-loader/lib/markdown-compiler.js?raw!./nginx代理.md\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./articles/nginx代理.md\n// module id = LZrs\n// module chunks = 4","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',[_c('h2',[_vm._v(\"nginx 代理\")]),_vm._v(\" \"),_c('p',[_vm._v(\"###nginx proxy pass示例\")]),_vm._v(\" \"),_c('p',[_vm._v(\"假设下面四种情况分别用 http://192.168.1.1/proxy/test.html进行访问\")]),_vm._v(\" \"),_c('pre',{pre:true,attrs:{\"class\":\"hljs\"}},[_c('code',{attrs:{\"v-pre\":\"\"}},[_vm._v(\"第一种：\\nlocation /proxy/ {\\n    proxy_pass http://127.0.0.1/;\\n}\\n代理到URL：http://127.0.0.1/test.html\\n\\n\\n第二种（相对于第一种，最后少一个 / ）\\nlocation /proxy/ {\\n    proxy_pass http://127.0.0.1;\\n}\\n代理到URL：http://127.0.0.1/proxy/test.html\\n\\n\\n第三种：\\nlocation /proxy/ {\\n    proxy_pass http://127.0.0.1/aaa/;\\n}\\n代理到URL：http://127.0.0.1/aaa/test.html\\n\\n\\n第四种（相对于第三种，最后少一个 / ）\\nlocation /proxy/ {\\n    proxy_pass http://127.0.0.1/aaa;\\n}\\n代理到URL：http://127.0.0.1/aaatest.html\\n\\n\")])]),_vm._v(\" \"),_c('h3',[_vm._v(\"nginx有两个模块都有proxy_pass指令\")]),_vm._v(\" \"),_c('h3',[_vm._v(\"ngx_http_proxy_module\")]),_vm._v(\" \"),_c('pre',{pre:true,attrs:{\"class\":\"hljs\"}},[_c('code',{attrs:{\"v-pre\":\"\"}},[_vm._v(\"  语法:  proxy_pass  URL;\\n  场景： location, if in location,limit_except\\n  说明： 设置后端代理服务器的协议（protocol)和地址(address),以及location中可以匹配的一个可选URI. 协议（http/https) 地址 域名/IP+port/unix-domain socket路径\\n  详见官方文档: http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass\\n\")])]),_vm._v(\" \"),_c('h3',[_vm._v(\"ngx_stream_proxy_module\")]),_vm._v(\" \"),_c('pre',{pre:true,attrs:{\"class\":\"hljs\"}},[_c('code',{attrs:{\"v-pre\":\"\"}},[_vm._v(\"  语法： proxy_pass address;\\n  场景   server\\n  说明：设置后端代理服务器地址。这个地址可以是 域名、ip+port 或者一个 unix-domain socket路径\\n  详见官方文档: http://nginx.org/en/docs/stream/ngx_stream_proxy_module.html#proxy_pass\\n\")])]),_vm._v(\" \"),_c('h3',[_vm._v(\"两个模块区别\")]),_vm._v(\" \"),_c('pre',{pre:true,attrs:{\"class\":\"hljs\"}},[_c('code',{attrs:{\"v-pre\":\"\"}},[_vm._v(\"在两个模块\\b中，两个proxy_pass都是用来做后端代理的指令。\\n\\nngx_stream_proxy_module模块的proxy_pass指令只能在server段使用使用, \\b只需要提供域名或ip地址和端口。可以理解为端口转发，可以是tcp端口，也可以是udp端口。\\n\\nngx_http_proxy_module模块的proxy_pass\\b指令需要在location段，location中的if段，limit_except段中使用，除了需要提供域名或ip地址和端口外，还需要提供协议，如\\\"http\\\"或\\\"https\\\"，还有一个可选的uri可以配置。\\n\\n\\n\")])]),_vm._v(\" \"),_c('h3',[_vm._v(\"具体使用\")]),_vm._v(\" \"),_c('p',[_vm._v(\"ngx_stream_proxy_module模块的proxy_pass指令\")]),_vm._v(\" \"),_c('pre',{pre:true,attrs:{\"class\":\"hljs\"}},[_c('code',{attrs:{\"v-pre\":\"\"}},[_vm._v(\"server {\\n    listen 127.0.0.1:12345;\\n    proxy_pass 127.0.0.1:8080;\\n}\\n\\nserver {\\n    listen 12345;\\n    proxy_connect_timeout 1s;\\n    proxy_timeout 1m;\\n    proxy_pass example.com:12345;\\n}\\n\\nserver {\\n    listen 53 udp;\\n    proxy_responses 1;\\n    proxy_timeout 20s;\\n    proxy_pass dns.example.com:53;\\n}\\n\\nserver {\\n    listen [::1]:12345;\\n    proxy_pass unix:/tmp/stream.socket;\\n}\\n\\n\")])]),_vm._v(\" \"),_c('p',[_vm._v(\"ngx_http_proxy_module模块 proxy_pass 指令\")]),_vm._v(\" \"),_c('pre',{pre:true,attrs:{\"class\":\"hljs\"}},[_c('code',{attrs:{\"v-pre\":\"\"}},[_vm._v(\"server {\\n    listen      80;\\n    server_name www.test.com;\\n\\n    # 正常代理，不修改后端url的\\n    location /some/path/ {\\n        proxy_pass http://127.0.0.1;\\n    }\\n\\n    # 修改后端url地址的代理（本例后端地址中，最后带了一个斜线)\\n    location /testb {\\n        proxy_pass http://www.other.com:8801/;\\n    }\\n\\n    # 使用 if in location\\n    location /google {\\n        if ( $geoip_country_code ~ (RU|CN) ) {\\n            proxy_pass http://www.google.hk;\\n        }\\n    }\\n\\n    location /yongfu/ {\\n        # 没有匹配 limit_except 的，代理到 unix:/tmp/backend.socket:/uri/\\n        proxy_pass http://unix:/tmp/backend.socket:/uri/;;\\n\\n        # 匹配到请求方法为: PUT or DELETE, 代理到9080\\n        limit_except PUT DELETE {\\n            proxy_pass http://127.0.0.1:9080;\\n        }\\n    }\\n\\n}\\n\")])]),_vm._v(\" \"),_c('h2',[_vm._v(\"proxy_pass后，后端服务器url（request_uri)情况分析\")]),_vm._v(\" \"),_c('pre',{pre:true,attrs:{\"class\":\"hljs\"}},[_c('code',{attrs:{\"v-pre\":\"\"}},[_vm._v(\"server {\\n    listen      80;\\n    server_name www.test.com;\\n\\n    # 情形A\\n    # 访问 http://www.test.com/testa/aaaa\\n    # 后端的request_uri为: /testa/aaaa\\n    location ^~ /testa/ {\\n        proxy_pass http://127.0.0.1:8801;\\n    }\\n\\n    # 情形B\\n    # 访问 http://www.test.com/testb/bbbb\\n    # 后端的request_uri为: /bbbb\\n    location ^~ /testb/ {\\n        proxy_pass http://127.0.0.1:8801/;\\n    }\\n\\n    # 情形C\\n    # 下面这段location是正确的\\n    location ~ /testc {\\n        proxy_pass http://127.0.0.1:8801;\\n    }\\n\\n    # 情形D\\n    # 下面这段location是错误的\\n    #\\n    # nginx -t 时，会报如下错误:\\n    #\\n    # nginx: [emerg] \\\"proxy_pass\\\" cannot have URI part in location given by regular\\n    # expression, or inside named location, or inside \\\"if\\\" statement, or inside\\n    # \\\"limit_except\\\" block in /opt/app/nginx/conf/vhost/test.conf:17\\n    #\\n    # 当location为正则表达式时，proxy_pass 不能包含URI部分。本例中包含了\\\"/\\\"\\n    location ~ /testd {\\n        proxy_pass http://127.0.0.1:8801/;   # 记住，location为正则表达式时，不能这样写！！！\\n    }\\n\\n    # 情形E\\n    # 访问 http://www.test.com/ccc/bbbb\\n    # 后端的request_uri为: /aaa/ccc/bbbb\\n    location /ccc/ {\\n        proxy_pass http://127.0.0.1:8801/aaa$request_uri;\\n    }\\n\\n    # 情形F\\n    # 访问 http://www.test.com/namea/ddd\\n    # 后端的request_uri为: /yongfu?namea=ddd\\n    location /namea/ {\\n        rewrite    /namea/([^/]+) /yongfu?namea=$1 break;\\n        proxy_pass http://127.0.0.1:8801;\\n    }\\n\\n    # 情形G\\n    # 访问 http://www.test.com/nameb/eee\\n    # 后端的request_uri为: /yongfu?nameb=eee\\n    location /nameb/ {\\n        rewrite    /nameb/([^/]+) /yongfu?nameb=$1 break;\\n        proxy_pass http://127.0.0.1:8801/;\\n    }\\n\\n    access_log /data/logs/www/www.test.com.log;\\n}\\n\\nserver {\\n    listen      8801;\\n    server_name www.test.com;\\n\\n    root        /data/www/test;\\n    index       index.php index.html;\\n\\n    rewrite ^(.*)$ /test.php?u=$1 last;\\n\\n    location ~ \\\\.php$ {\\n        try_files $uri =404;\\n        fastcgi_pass unix:/tmp/php-cgi.sock;\\n        fastcgi_index index.php;\\n        include fastcgi.conf;\\n    }\\n\\n    access_log /data/logs/www/www.test.com.8801.log;\\n}\\n\\n\")])])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-3529a317\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./node_modules/vue-markdown-loader/lib/markdown-compiler.js?raw!./articles/nginx代理.md\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nvar __vue_script__ = null\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3529a317\\\",\\\"hasScoped\\\":false,\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!../node_modules/vue-markdown-loader/lib/markdown-compiler.js?raw!./nginx代理.md\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader!./node_modules/vue-markdown-loader/lib/markdown-compiler.js?raw!./articles/nginx代理.md\n// module id = null\n// module chunks = "],"sourceRoot":""}